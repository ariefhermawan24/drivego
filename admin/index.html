<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveGo - Admin</title>
    <link rel="shortcut icon" type="image/png" href="../admin/source/image/tittle-logo.png" />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="../admin/source/css/admin.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="icon"><img src="../admin/source/image/tittle-logo.png" alt="Logo"></i>
            <span class="logo-text"><span class="white">Drive</span><span class="orange">Go</span></span>
            <span class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></span>
        </div>
        <ul>
            <li id="dashboard-btn"><i class="fas fa-home"></i> <span>Dashboard</span></li>
            <div class="divider"></div>
            <li onclick="toggleSubmenu(this)" class="menu-induk"><i class="fas fa-user-check"></i> <span>User Validation</span><i class="fas fa-chevron-down arrow"></i></li>
            <ul class="submenu">
                <li><i class="fas fa-info-circle"></i> <span>Rental Status</span></li>
                <li><i class="fas fa-check"></i> <span>Request Validation</span></li>
                <li><i class="fas fa-check-circle"></i> <span>Rent Accepted</span></li>
                <li><i class="fas fa-times-circle"></i> <span>Rent Rejected</span></li>
            </ul>
            <div class="divider"></div>
            <li onclick="toggleSubmenu(this)" class="menu-induk"><i class="fas fa-car"></i> <span>Manage Car</span><i class="fas fa-chevron-down arrow"></i></li>
            <ul class="submenu">
                <li data-page="datamobil"><i class="fas fa-list"></i> <span>Car Detail</span></li>
                <li data-page="imagemobil"><i class="fas fa-image"></i> <span>Car Photo</span></li>
            </ul>
            <div class="divider"></div>
            <li onclick="toggleSubmenu(this)" class="menu-induk"><i class="fas fa-tools"></i> <span>Manage Garage</span><i class="fas fa-chevron-down arrow"></i></li>
            <ul class="submenu">
                <li data-page="datagarasi"><i class="fas fa-warehouse"></i><span>Garage Detail</span></li>
            </ul>
            <div class="divider"></div>
            <li onclick="toggleSubmenu(this)" class="menu-induk"><i class="fas fa-id-badge"></i> <span>Manage Drivers</span><i class="fas fa-chevron-down arrow"></i></li>
            <ul class="submenu">
                <li data-page="datasupir"><i class="fas fa-id-card"></i> <span>Driver Details</span></li>
            </ul>
        </ul>
        <button class="toggle-btn-bottom" id="toggleBtnBottom" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
    </div>
    <!-- Wrapper agar layout menjadi atas-bawah -->
    <div class="main-container">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-center">
                <i class="fas fa-cogs"></i>
                <span>Administrator Panel</span>
            </div>
            <div class="navbar-right">
                <div class="account-dropdown">
                    <div class="user-info">
                        <span id="navbarUsername"></span>
                    </div>
                    <i class="fas fa-user-circle account-icon" onclick="toggleDropdown()"></i>
                    <div class="dropdown-content" id="accountDropdown">
                        <div class="dropdownuser-info">
                            <i class="fas fa-user-circle user-icon"></i>
                            <div class="user-details">
                                <span id="dropdownUsername"></span>
                                <span id="dropdownRole"></span>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" data-bs-toggle="modal" data-bs-target="#accountModal"><i class="fas fa-user" ></i> Detail Account</a>
                        <a class="logout" href="#"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Content -->
        <div id="content" class="content p-3">
            <h2>Welcome to DriveGo</h2>
            <p>Content goes here...</p>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 DriveGo. All rights reserved.</p>
        </footer>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="accountModal" tabindex="-1" aria-labelledby="accountModalLabel">
        <div class="modal-dialog">
            <div class="modal-content bg-dark text-light">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title" id="accountModalLabel">Detail Akun</h5>
                    <span type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></span>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <i class="fas fa-user-circle fa-5x text-light"></i>
                        <h5 id="modalUsername" class="mt-2"></h5>
                        <p id="modalEmail" class="text-muted" style="color: white !important;"></p>
                    </div>
                    <hr class="border-secondary">
                    <ul class="list-group">
                        <li class="list-group-item bg-dark text-light border-secondary">
                            <strong>Role:</strong> <span id="modalRole"></span>
                        </li>
                        <li class="list-group-item bg-dark text-light border-secondary">
                            <strong>Telepon:</strong> <span id="modalTelepon"></span>
                        </li>
                        <li class="list-group-item bg-dark text-light border-secondary">
                            <strong>Pertanyaan Keamanan:</strong> <span id="modalSoal"></span>
                        </li>
                        <li class="list-group-item bg-dark text-light border-secondary">
                            <strong>Jawaban Keamanan:</strong> <span id="modalJawaban"></span>
                        </li>
                    </ul>
                </div>
                <div class="modal-footer border-secondary">
                    <div class="container">
                        <div class="row g-2 justify-content-center text-center">
                            <div class="col-12 col-sm-6">
                                <button type="button" class="btn btn-warning w-100" id="editUserBtn">
                                    <i class="fas fa-user-edit me-1"></i> Edit User
                                </button>
                            </div>
                            <div class="col-12 col-sm-6">
                                <button type="button" class="btn btn-info w-100" id="editPasswordBtn">
                                    <i class="fas fa-key me-1"></i> Edit Password
                                </button>
                            </div>
                            <div class="col-12 col-sm-6">
                                <button type="button" class="btn btn-primary w-100" id="editQuestionBtn">
                                    <i class="fas fa-question-circle me-1"></i> Edit Soal Keamanan
                                </button>
                            </div>
                            <div class="col-12 col-sm-6">
                                <button type="button" class="btn btn-danger w-100" id="logout">
                                    <i class="fas fa-sign-out-alt me-1"></i> Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!-- Modal Tambah Mobil -->
<div class="modal fade" id="modalTambahMobil" tabindex="-1" aria-labelledby="modalTambahMobilLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-dark text-white" style="max-height: 90vh;">
      <div class="modal-header border-secondary sticky-top bg-dark">
        <h5 class="modal-title" id="modalTambahMobilLabel">Tambah Mobil</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body overflow-auto" style="max-height: 65vh;">
        <form id="formTambahMobil">
          <div class="mb-3">
            <label for="namaMobil" class="form-label">Nama Mobil</label>
            <input type="text" id="namaMobil" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="merkMobil" class="form-label">Merek Mobil</label>
            <input type="text" id="merkMobil" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="tahunMobil" class="form-label">Tahun</label>
            <input type="number" id="tahunMobil" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="warnaMobil" class="form-label">Warna</label>
            <input type="text" id="warnaMobil" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="transmisiMobil" class="form-label">Transmisi</label>
            <select id="transmisiMobil" class="form-select bg-secondary text-white border-0" required>
              <option value="manual">Manual</option>
              <option value="automatic">Matic</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="bahanBakarMobil" class="form-label">Bahan Bakar</label>
            <select id="bahanBakarMobil" class="form-select bg-secondary text-white border-0" required>
              <optgroup label="Bahan Bakar Bensin">
                    <option value="pertalite">Pertalite</option>
                        <option value="pertamax">Pertamax</option>
                        <option value="pertamax-turbo">Pertamax Turbo</option>
                    </optgroup>

                    <optgroup label="Bahan Bakar Solar / Diesel">
                        <option value="solar">Solar Subsidi</option>
                        <option value="dexlite">Dexlite</option>
                        <option value="pertamina-dex">Pertamina Dex</option>
                    </optgroup>

                    <optgroup label="Bahan Bakar Ramah Lingkungan">
                        <option value="listrik">Listrik (Full Electric)</option>
                        <option value="hybrid">Hybrid (Bensin + Listrik)</option>
                        <option value="plug-in-hybrid">Plug-in Hybrid (Colokan Listrik + Bensin)</option>
                    </optgroup>
            </select>
          </div>
          <div class="mb-3">
            <label for="jumlahTempatDuduk" class="form-label">Jumlah Tempat Duduk</label>
            <input type="number" id="jumlahTempatDuduk" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="GarasiMobil" class="form-label">Garasi</label>
            <select id="GarasiMobil" class="form-select bg-secondary text-white border-0 GarasiMobil" required>
                <option value="" disabled>Pilih Garasi</option>
                <!-- Opsi akan diisi dari JavaScript -->
            </select>
          </div>
          <div class="mb-3">
            <label for="tipemobil" class="form-label">Tipe Mobil</label>
            <select id="tipemobil" class="form-select bg-secondary text-white border-0" required>
                <optgroup label="Mobil Keluarga">
                    <option value="mpv">MPV (Mobil Keluarga 7 Penumpang)</option>
                    <option value="minibus">Minibus (Kapasitas Besar)</option>
                    <option value="van">Van (Mobil Barang/Penumpang Besar)</option>
                </optgroup>

                <optgroup label="Mobil Perkotaan">
                    <option value="city-car">City Car (Mobil Perkotaan)</option>
                    <option value="hatchback">Hatchback (Bagasi Menyatu)</option>
                    <option value="sedan">Sedan (Mobil Sedan)</option>
                    <option value="crossover">Crossover (Gabungan Sedan & SUV)</option>
                </optgroup>

                <optgroup label="Mobil SUV & Offroad">
                    <option value="suv">SUV (Sport Utility Vehicle)</option>
                    <option value="offroad">Offroad (Khusus Medan Berat)</option>
                    <option value="double-cabin">Double Cabin (Pickup 4 Pintu)</option>
                </optgroup>

                <optgroup label="Mobil Mewah & Spesial">
                    <option value="luxury">Luxury Car (Mobil Mewah)</option>
                    <option value="convertible">Convertible (Atap Terbuka)</option>
                    <option value="coupe">Coupe (2 Pintu Sporty)</option>
                    <option value="electric">Mobil Listrik</option>
                </optgroup>
            </select>
          </div>
          <div class="mb-3">
            <label for="StatusMobil" class="form-label">Status</label>
            <select id="StatusMobil" class="form-control bg-secondary text-white border-0">
              <option value="tersedia">Tersedia</option>
              <option value="disewa">Disewa</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="HargaSewa" class="form-label">Harga Sewa</label>
            <input type="number" id="HargaSewa" class="form-control bg-secondary text-white border-0" required>
          </div>
          <div class="mb-3">
            <label for="fotomobil" class="form-label">Foto Mobil</label>

            <div class="input-group">
                <!-- Input readonly -->
                <input type="text" class="form-control bg-secondary text-white border-0" placeholder="Pilih file gambar..." id="namaFile" readonly>

                <!-- Clear/reset button -->
                <button type="button" class="btn btn-secondary d-none" id="resetButton" onclick="resetFile()">
                <i class="fa-solid fa-xmark"></i>
                </button>

                <!-- Browse button -->
                <button type="button" class="btn btn-warning" onclick="document.getElementById('fotomobil').click()">
                <i class="fa-solid fa-folder-open"></i>
                </button>
            </div>

            <!-- Hidden file input -->
            <input type="file" id="fotomobil" class="d-none" accept="image/*" required>

            <div class="form-text text-warning">Maksimal ukuran gambar 1MB.</div>
            </div>

            <!-- Progress bar upload Cloudinary -->
          <div class="progress my-2" style="height: 20px; display: none;" id="progressContainer">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" id="progressBar" style="width: 0%;">0%</div>
          </div>
        </form>
      </div>
      <div class="modal-footer border-secondary sticky-bottom bg-dark">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        <button type="submit" form="formTambahMobil" class="btn btn-primary">Simpan</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edit Mobil -->
<div class="modal fade" id="modalEditMobil" tabindex="-1" aria-labelledby="modalEditMobilLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-dark text-white" style="max-height: 90vh; border: 1px solid #444;">
      <div class="modal-header border-secondary sticky-top bg-dark">
        <h5 class="modal-title fs-4 text-primary fw-bold" id="modalEditMobilLabel">
          <i class="fas fa-car me-2"></i>Edit Mobil
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body overflow-auto" style="max-height: 65vh;">
        <form id="formEditMobil" class="needs-validation" novalidate>
          <div class="row g-3">
            <input type="hidden" id="editMobilId">
            <!-- Kolom Kiri -->
            <div class="col-md-6">
              <div class="mb-3">
                <label for="editNamaMobil" class="form-label">Nama Mobil</label>
                <div class="input-group">
                    <span class="input-group-text bg-dark border-secondary text-white">
                    <i class="fas fa-car-side"></i>
                    </span>
                    <input type="text" id="editNamaMobil" class="form-control bg-dark text-white border-secondary" required pattern=".{3,}">
                    <span class="input-group-text bg-dark border-secondary text-white" id="displayInisialMobil">
                    DAXE 01
                    </span>
                </div>
              </div>

              <div class="mb-3">
                <label for="editMerkMobil" class="form-label">Merek Mobil</label>
                <div class="input-group">
                  <span class="input-group-text bg-dark border-secondary text-white"><i class="fas fa-trademark"></i></span>
                  <input type="text" id="editMerkMobil" class="form-control bg-dark text-white border-secondary" required>
                </div>
              </div>

              <div class="mb-3">
                <label for="edittahunMobil" class="form-label">Tahun</label>
                <div class="input-group">
                  <span class="input-group-text bg-dark border-secondary text-white"><i class="fas fa-calendar-alt"></i></span>
                  <input type="number" id="edittahunMobil" class="form-control bg-dark text-white border-secondary" 
                         min="2000" max="2024" required>
                </div>
              </div>

              <div class="mb-3">
                <label for="editwarnaMobil" class="form-label">Warna</label>
                <div class="input-group">
                  <span class="input-group-text bg-dark border-secondary text-white"><i class="fas fa-palette"></i></span>
                  <input type="text" id="editwarnaMobil" class="form-control bg-dark text-white border-secondary" required>
                </div>
              </div>
            </div>

            <!-- Kolom Kanan -->
            <div class="col-md-6">
              <div class="mb-3">
                <label for="edittransmisiMobil" class="form-label">Transmisi</label>
                <select id="edittransmisiMobil" class="form-select bg-dark text-white border-secondary" required>
                  <option value="manual" class="bg-secondary">Manual</option>
                  <option value="automatic" class="bg-secondary">Matic</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="editbahanBakarMobil" class="form-label">Bahan Bakar</label>
                <select id="editbahanBakarMobil" class="form-select bg-dark text-white border-secondary" required>
                  <optgroup label="Bahan Bakar Bensin" class="bg-secondary">
                    <option value="pertalite">Pertalite</option>
                    <option value="pertamax">Pertamax</option>
                    <option value="pertamax-turbo">Pertamax Turbo</option>
                  </optgroup>

                  <optgroup label="Solar / Diesel" class="bg-secondary">
                    <option value="solar">Solar Subsidi</option>
                    <option value="dexlite">Dexlite</option>
                    <option value="pertamina-dex">Pertamina Dex</option>
                  </optgroup>

                  <optgroup label="Ramah Lingkungan" class="bg-secondary">
                    <option value="listrik">Listrik</option>
                    <option value="hybrid">Hybrid</option>
                    <option value="plug-in-hybrid">Plug-in Hybrid</option>
                  </optgroup>
                </select>
              </div>

              <div class="mb-3">
                <label for="editjumlahTempatDuduk" class="form-label">Kursi</label>
                <div class="input-group">
                  <span class="input-group-text bg-dark border-secondary text-white"><i class="fas fa-chair"></i></span>
                  <input type="number" id="editjumlahTempatDuduk" class="form-control bg-dark text-white border-secondary" 
                         min="2" max="12" required>
                </div>
              </div>

              <div class="mb-3">
                <label for="editHargaSewa" class="form-label">Harga Sewa</label>
                <div class="input-group">
                  <span class="input-group-text bg-dark border-secondary text-white">Rp</span>
                  <input type="number" id="editHargaSewa" class="form-control bg-dark text-white border-secondary" 
                         min="100000" step="50000" required>
                  <span class="input-group-text bg-dark border-secondary text-white">/hari</span>
                </div>
                <div class="form-text">Minimal Rp 100.000</div>
              </div>
            </div>
          </div>

          <!-- Bagian Bawah -->
          <div class="row g-3">
            <div class="col-md-4">
              <div class="mb-3">
                <label for="editGarasiMobil" class="form-label">Garasi</label>
                <select id="editGarasiMobil" class="form-select bg-dark text-white border-secondary GarasiMobil" required>
                  <option value="" disabled class="bg-secondary">Pilih Garasi</option>
                  <!-- Opsi akan diisi dari JavaScript -->
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="mb-3">
                <label for="editTipeMobil" class="form-label">Tipe Mobil</label>
                <select id="editTipeMobil" class="form-select bg-dark text-white border-secondary" required>
                  <optgroup label="Mobil Keluarga">
                    <option value="mpv">MPV (Mobil Keluarga 7 Penumpang)</option>
                    <option value="minibus">Minibus (Kapasitas Besar)</option>
                    <option value="van">Van (Mobil Barang/Penumpang Besar)</option>
                </optgroup>

                <optgroup label="Mobil Perkotaan">
                    <option value="city-car">City Car (Mobil Perkotaan)</option>
                    <option value="hatchback">Hatchback (Bagasi Menyatu)</option>
                    <option value="sedan">Sedan (Mobil Sedan)</option>
                    <option value="crossover">Crossover (Gabungan Sedan & SUV)</option>
                </optgroup>

                <optgroup label="Mobil SUV & Offroad">
                    <option value="suv">SUV (Sport Utility Vehicle)</option>
                    <option value="offroad">Offroad (Khusus Medan Berat)</option>
                    <option value="double-cabin">Double Cabin (Pickup 4 Pintu)</option>
                </optgroup>

                <optgroup label="Mobil Mewah & Spesial">
                    <option value="luxury">Luxury Car (Mobil Mewah)</option>
                    <option value="convertible">Convertible (Atap Terbuka)</option>
                    <option value="coupe">Coupe (2 Pintu Sporty)</option>
                    <option value="electric">Mobil Listrik</option>
                </optgroup>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="mb-3">
                <label for="editStatusMobil" class="form-label">Status</label>
                <select id="editStatusMobil" class="form-select bg-dark text-white border-secondary">
                  <option value="tersedia" class="text-success">Tersedia</option>
                  <option value="disewa" class="text-danger">Disewa</option>
                </select>
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer border-secondary sticky-bottom bg-dark d-flex justify-content-between">
        <button type="button" class="btn btn-outline-secondary" id="resetEditMobilButton">
            <i class="fas fa-undo me-2"></i>Reset Form
        </button>
        <button type="submit" form="formEditMobil" class="btn btn-success">
          <i class="fas fa-save me-2"></i>Simpan Perubahan
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edit Foto Mobil -->
<div class="modal fade" id="modalEditFoto" tabindex="-1" aria-labelledby="modalEditFotoLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-dark text-white">
      
      <!-- Header (tetap) -->
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title" id="modalEditFotoLabel">Edit Foto Mobil - <span id="nama-mobil"></span></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <!-- Body (scrollable) -->
      <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
        <div class="d-flex flex-wrap justify-content-center align-items-start mb-3">
          <!-- Preview Foto Lama -->
          <div class="text-center me-3 mb-3">
            <label class="form-label fw-bold">Foto Saat Ini</label><br>
            <img id="currentFotoMobil" src="" alt="Foto Mobil Saat Ini"
              style="width: 250px; height: 150px; border-radius: 8px; object-fit: cover;" />
          </div>

          <!-- Preview Foto Baru -->
          <div class="text-center mb-3 preview d-none">
            <label class="form-label fw-bold">Foto Terbaru Nanti</label><br>
            <img id="previewFoto" src="" alt="Foto Mobil Saat Ini"
              style="width: 250px; height: 150px; border-radius: 8px; object-fit: cover;" />
          </div>
        </div>

        <!-- Progress bar upload Cloudinary -->
        <div class="progress my-2" style="height: 20px; display: none;" id="progressContainerEdit">
          <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" id="progressBarEdit" style="width: 0%;">0%</div>
        </div>

        <!-- Form Upload Foto Baru (Edit Mobil) -->
        <div class="mb-3">
          <label class="form-label fw-bold">Ganti Foto Mobil</label>

          <div class="input-group">
            <!-- Input readonly -->
            <input type="text" class="form-control bg-secondary text-white border-0" placeholder="Pilih file gambar..." id="namaFileEdit" readonly>

            <!-- Clear/reset button -->
            <button type="button" class="btn btn-secondary d-none" id="resetButtonEdit" onclick="resetFileEdit()">
              <i class="fa-solid fa-xmark"></i>
            </button>

            <!-- Browse button -->
            <button type="button" class="btn btn-warning" onclick="document.getElementById('fotomobilEdit').click()">
              <i class="fa-solid fa-folder-open"></i>
            </button>
          </div>

          <!-- Hidden file input -->
          <input type="file" id="fotomobilEdit" class="d-none" accept="image/*" required>

          <!-- Preview foto baru -->
          <div class="mt-3 text-center">
            <img id="previewFotoBaruEdit" src="" alt="Preview Foto Baru" style="width: 250px; height: 150px; border-radius: 8px; object-fit: cover; display: none;" />
          </div>

          <div class="form-text text-warning">Maksimal ukuran gambar 1MB.</div>
        </div>
      </div>

      <!-- Footer (tetap) -->
      <div class="modal-footer bg-dark">
        <button type="button" class="btn btn-light" data-bs-dismiss="modal">Batal</button>
        <button type="button" class="btn btn-warning" onclick="uploadFotoMobilEdit()" id="uploadEditFoto">Upload Foto</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edit Garasi -->
<div class="modal fade" id="editGarasiModal" tabindex="-1" aria-labelledby="editGarasiModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark">
      <div class="modal-header">
        <h5 class="modal-title text-white" id="editGarasiModalLabel">Edit Garasi</h5>
        <span type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></span>
      </div>
      <div class="modal-body">
        <form id="editGarasiForm">
          <div class="mb-3">
            <label for="editNamaTempat" class="form-label text-white">Kota</label>
            <input type="text" class="form-control text-white bg-dark" id="editNamaTempat" name="kota" placeholder="Masukkan nama kota" required>
          </div>
          <div class="mb-3">
            <label for="editAlama t" class="form-label text-white">Alamat</label>
            <input type="text" class="form-control text-white bg-dark" id="editAlamat" name="alamat" placeholder="Masukkan alamat lengkap" required>
          </div>
          <div class="mb-3">
            <label for="editTelepon" class="form-label text-white">Telepon</label>
            <input type="tel" class="form-control text-white bg-dark" id="editTelepon" name="telepon" placeholder="Masukkan nomor telepon" required>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="submit" class="btn btn-primary">Update</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!-- Modal Tambah Garasi with Dark Theme -->
<div class="modal fade" id="modalTambahGarasi" tabindex="-1" aria-labelledby="modalTambahGarasiLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTambahGarasiLabel">Tambah Garasi</h5>
        <span type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></span>
      </div>
      <div class="modal-body">
        <form id="formTambahGarasi">
          <div class="mb-3">
            <label for="namaTempat" class="form-label">Kota</label>
            <input type="text" class="form-control bg-dark text-white" id="namaTempat" required>
          </div>
          <div class="mb-3">
            <label for="alamat" class="form-label">Alamat</label>
            <input type="text" class="form-control bg-dark text-white" id="alamat" required>
          </div>
          <div class="mb-3">
            <label for="telepon" class="form-label">Telepon</label>
            <input type="text" class="form-control bg-dark text-white" id="telepon" required>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
        <button type="button" class="btn btn-primary" onclick="tambahGarasi()">Tambah</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Tambah Sopir -->
<!-- Modal Tambah Sopir -->
<div class="modal fade" id="modalTambahSopir" tabindex="-1" aria-labelledby="modalTambahSopirLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTambahSopirLabel"><i class="fas fa-user-plus me-2"></i>Tambah Supir Baru</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="formTambahSopir">
          <div class="mb-4">
            <label for="namaSopir" class="form-label"><i class="fas fa-user me-2"></i>Nama</label>
            <input type="text" class="form-control" id="namaSopir" required placeholder="Masukkan nama lengkap">
          </div>
          
          <div class="mb-4">
            <label for="teleponSopir" class="form-label"><i class="fas fa-phone me-2"></i>Nomor Telephone</label>
            <input type="tel" class="form-control" id="teleponSopir" required placeholder="Contoh: 081234567890">
          </div>
          
          <div class="mb-4">
            <label for="emailSopir" class="form-label"><i class="fas fa-envelope me-2"></i>Email</label>
            <input type="email" class="form-control" id="emailSopir" required placeholder="Contoh: example@mail.com">
          </div>
          
          <div class="mb-4">
            <label for="statusSopir" class="form-label"><i class="fas fa-circle-check me-2"></i>Status</label>
            <select class="form-select" id="statusSopir" required>
              <option value="tersedia" class="text-success">🟢 Tersedia</option>
              <option value="tidak tersedia" class="text-danger">🔴 Tidak Tersedia</option>
            </select>
          </div>
          
          <div class="modal-footer border-top-0">
            <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">Tutup</button>
            <button type="submit" class="btn btn-primary px-4">
              <i class="fas fa-save me-2"></i>Simpan
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


    <script type="module" src="../admin/admin.js"> </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            async function loadPage(page) {
                const contentContainer = document.getElementById("content");
                if (!contentContainer) return;

                try {
                    const response = await fetch(`content/${page}.html`);
                    if (!response.ok) throw new Error("Page not found");
                    const html = await response.text();
                    contentContainer.innerHTML = html;

                    // Hapus script lama sebelum menambahkan yang baru
                    document.querySelectorAll("script[data-dynamic]").forEach(script => script.remove());

                    // Load CSS dinamis
                    document.querySelectorAll("link[data-dynamic]").forEach(link => link.remove());
                    const linkElement = document.createElement("link");
                    linkElement.rel = "stylesheet";
                    linkElement.href = `source/css/${page}.css`;
                    linkElement.setAttribute("data-dynamic", "true");
                    document.head.appendChild(linkElement);

                    // Load JS Dinamis dengan Import
                    try {
                        const modulePath = `./script/${page}.js`;
                        await import(modulePath + `?t=${Date.now()}`); // Mencegah cache
                    } catch (err) {
                        console.error(`Error loading script: ${page}.js`, err);
                    }

                } catch (error) {
                    contentContainer.innerHTML = "<h2>Page not found</h2>";
                }
            }

            // Fungsi navigasi halaman
            function navigateTo(page) {
                history.pushState({}, "", `?page=${page}`);
                loadPage(page);
            }

            // Event listener untuk tombol dashboard (karena tidak memiliki data-page)
            document.getElementById("dashboard-btn").addEventListener("click", function () {
                history.pushState({}, "", "?");
                loadPage("dashboard");
            });

            // Event listener untuk menu navigasi lainnya
            document.querySelectorAll("li[data-page]").forEach(li => {
                li.addEventListener("click", function () {
                    const page = this.getAttribute("data-page");
                    navigateTo(page);
                });
            });

            // Tangani perubahan history API (tombol back/forward browser)
            window.addEventListener("popstate", () => {
                const params = new URLSearchParams(window.location.search);
                const page = params.get("page") || "dashboard";
                loadPage(page);
            });

            // Muat halaman pertama kali sesuai URL atau default ke dashboard
            const initialPage = new URLSearchParams(window.location.search).get("page") || "dashboard";
            loadPage(initialPage);
        });

        function toggleSidebar() {
            let sidebar = document.getElementById("sidebar");
            sidebar.classList.toggle("minimized");

            // Reset semua submenu jika sidebar diminimized
            if (sidebar.classList.contains("minimized")) {
                let allSubmenus = document.querySelectorAll(".submenu");
                let allMenuItems = document.querySelectorAll(".sidebar ul li");
                let allArrows = document.querySelectorAll(".arrow");

                allSubmenus.forEach(submenu => {
                    submenu.style.maxHeight = null;
                    submenu.style.opacity = "0";
                });

                allMenuItems.forEach(item => {
                    item.classList.remove("active");
                });

                allArrows.forEach(arrow => {
                    arrow.style.transform = "rotate(0deg)"; // Reset panah ke bawah
                });
            }
        }

        function toggleSubmenu(element) {
            let sidebar = document.getElementById("sidebar");
            
            // Jika sidebar dalam mode minimized, buka kembali
            if (sidebar.classList.contains("minimized")) {
                sidebar.classList.remove("minimized");
            }

            let submenu = element.nextElementSibling;
            let arrow = element.querySelector(".arrow");

            // Toggle class active untuk menu utama
            element.classList.toggle("active");

            // Toggle submenu dengan efek sliding & panah animasi
            if (submenu.style.maxHeight) {
                submenu.style.maxHeight = null;
                submenu.style.opacity = "0";
                arrow.style.transform = "rotate(0deg)"; // Panah ke bawah
            } else {
                submenu.style.maxHeight = submenu.scrollHeight + "px";
                submenu.style.opacity = "1";
                arrow.style.transform = "rotate(180deg)"; // Panah ke atas
            }
        }

        function toggleDropdown() {
            let dropdown = document.getElementById("accountDropdown");

            if (dropdown.classList.contains("show")) {
                dropdown.classList.remove("show");
                dropdown.classList.add("hide");

                // Tunggu animasi selesai sebelum menyembunyikan elemen
                setTimeout(() => {
                    dropdown.style.display = "none";
                }, 300); // Sesuai durasi animasi CSS
            } else {
                dropdown.style.display = "block"; // Tampilkan dulu sebelum mulai animasi
                setTimeout(() => {
                    dropdown.classList.add("show");
                    dropdown.classList.remove("hide");
                }, 10);
            }
        }

        // Menutup dropdown jika klik di luar
        window.onclick = function(event) {
            let dropdown = document.getElementById("accountDropdown");
            if (!event.target.closest('.account-icon') && dropdown.classList.contains("show")) {
                dropdown.classList.remove("show");
                dropdown.classList.add("hide");

                setTimeout(() => {
                    dropdown.style.display = "none";
                }, 300);
            }
        };

        const fotomobil = document.getElementById('fotomobil');
        const namaFileInput = document.getElementById('namaFile');
        const resetButton = document.getElementById('resetButton');

        fotomobil.addEventListener('change', function() {
          const file = this.files[0];

          if (file) {
            if (file.size > 1 * 1024 * 1024) { // 1MB
              alert('Ukuran file terlalu besar! Maksimal 1MB.');
              this.value = '';
              namaFileInput.value = '';
              resetButton.classList.add('d-none');
            } else {
              namaFileInput.value = file.name;
              resetButton.classList.remove('d-none');
            }
          } else {
            namaFileInput.value = '';
            resetButton.classList.add('d-none');
          }
        });

        function resetFile() {
          fotomobil.value = '';
          namaFileInput.value = '';
          resetButton.classList.add('d-none');
        }

        // Event saat file input berubah
        document.getElementById('fotomobilEdit').addEventListener('change', function (event) {
          const fileInput = event.target;
          const file = fileInput.files[0];

          if (file) {
            // Tampilkan nama file di input readonly
            document.getElementById('namaFileEdit').value = file.name;

            // Tampilkan preview gambar baru
            const preview = document.getElementById('previewFoto');
            preview.src = URL.createObjectURL(file);

            // Tampilkan parent div preview
            const previewContainer = document.querySelector('.preview');
            previewContainer.classList.remove('d-none');
            previewContainer.style.display = 'block';

            // Tampilkan tombol reset
            document.getElementById('resetButtonEdit').classList.remove('d-none');
          }
        });

        // Fungsi reset form file input
        function resetFileEdit() {
          const fileInput = document.getElementById('fotomobilEdit');
          const preview = document.getElementById('previewFotoBaruEdit');
          const previewContainer = document.querySelector('.preview');
          const namaFile = document.getElementById('namaFileEdit');
          const resetButton = document.getElementById('resetButtonEdit');

          // Reset input file
          fileInput.value = '';

          // Sembunyikan preview
          preview.src = '';
          preview.style.display = 'none';

          // Hapus nama file
          namaFile.value = '';

          // Sembunyikan tombol reset
          resetButton.classList.add('d-none');

          previewContainer.style.display = 'none';
        }

    </script>
</body>
</html>
